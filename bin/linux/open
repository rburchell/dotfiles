#!/bin/sh
if [ -z "$1" ]; then
    echo "Need a thing to open"
    exit 1
fi

txtList=""

for var in "$@"; do
    if [ -d "$var" ]; then
        # for whatever reason, xdg-open can't handle this.
        echo "Opening $var as directory"
        gnome-open "$var"
    else
        # if it's text, i want to be able to view it in an editor. no exceptions.
        file "$var" | grep "text"
        if [ $? -ne 0 ]; then
            # and if it's not, i want to open it "normally".
            echo "Opening $var via XDG"
            xdg-open "$var"
        else
            echo "Opening $var as text"
            txtList="$txtList $var"
        fi
    fi
done

if [ ! -z "$txtList" ]; then
    gvim --servername "GVIM" --remote-tab-silent "+|" $txtList
fi
