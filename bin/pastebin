#!/bin/sh
if ! [ -z "$1" ]; then
    if ! [ -f "$1" ]; then
        echo "$0: file does not exist"
        exit 1
    fi
    ext=`echo $1 | awk -F . '{ print $NF } '`
    rand=$(randstr)
    cp "$1" /tmp/$rand.$ext
    url=$(upload /tmp/$rand.$ext)
    echo "pasted $url"
    rm /tmp/$rand.$ext
else
    data="$(pbpaste)"
    rand=$(randstr)
    echo "$data" > "/tmp/$rand.txt"
    url=$(upload /tmp/$rand.txt)
    rm /tmp/$rand.txt
    echo "pasted $url"
    echo $url | pbcopy
fi

